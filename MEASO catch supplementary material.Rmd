---
title: "MEASO fishery statistics"
author: "Andrew Constable"
date: "16/09/2020"
output: 
  bookdown::html_document2:
    toc: true
    toc_depth: 4
    fig_caption: yes
bibliography: 'C:\\_w\\_r\\Southern-Ocean-Catch\\CatchRefs.bibtex'   

---

```{r setup, include=FALSE}


knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(scales)
library(png) # for grabbing dimensions of png files
library(dplyr)


WorkDir<-('C:\\_w\\_d\\Catch\\')

# Editing and Development Notes:
#
# 1. This code is inherited from "MEASO CCAMLR catch data.rmd" which has the basic analyses testing the data.  
            # The code here strips away the testing routines.
#

# Output flags

printMaps<-FALSE


############# data files needed to support analyses #######################


# files from CCAMLR Statistical Bulletin 2019

CSBdata           <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\AggregatedFisheryCatch.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CEdata            <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\AggregatedFisheryEffort.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CRcountry         <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataCountry.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CRfishingActivity <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataFishingActivity.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CRfishingGear     <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataFishingGear.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CRgeographicArea  <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataGeographicArea_to_MEASO.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CRvesselSize      <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataVesselSize.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
CSB_taxa          <-read.csv2(paste(WorkDir,'CCAMLR_2019_Stat_Bull_data_Files\\ReferenceDataTaxon_MEASO.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")

# files with results from manual assignment of records to location of fishing gears - bottom (B) or midwater (M)
resultsDir<-"C:/_w/_r/Southern-Ocean-Catch/"
data_Location_B_M_Step_1<-read.csv2(paste(resultsDir,'B-M Step1.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")
data_Location_B_M_Step_2<-read.csv2(paste(resultsDir,'B-M Step2.csv',sep="")
                              , header = TRUE, sep = ",", dec = ".")

# for distribution of catches among MEASO areas
Seabed_file<-"C:\\_w\\_d\\seabed GEBCO\\GEBCO_cells_ASD_MEASO_ssmu_ssru.rds"


################# input data to support analyses #################


TF_Names<-data.frame(TFn     = c(           1,        2,          3,           4,           5,      6,      7,      8)
                    ,Fishery = c("Groundfish","Icefish","Toothfish","Silverfish","Myctophids","Krill","Squid","Crabs")
                    ,Colour  = c("darkslategray","grey80","bisque3","lightsteelblue1","thistle3","coral2","cadetblue4","salmon4"))

GT_Names<-data.frame(GTn      = c(   1,    2,    3,    4,   5,   6,    7,    8,   9,   10,  11)
                    ,Gear     = c("TX", "OT","OTB","TBB","OTM","TMB","TM","LLS","FPO","JIG","SX")
                    ,Location = c( "B",  "U",  "B",  "B",  "M",  "M", "M",  "B",  "B",  "M", "M")  # midwater = "M", bottom = "B"
                    ,Colour   = c("grey5","grey20","grey35","grey50","darkslategray4","darkslategray3","darkslategray2","coral3","coral1","orchid3","firebrick"))

CT_Names<-data.frame(
          CTn      = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26)
         ,CTY_Code = c("ARG", "AUS", "BGR", "CHL", "CHN", "FRA", "DDR", "DEU", "IND", "JPN", "KOR", "LVA", "NAM"
                      ,"NOR", "NZL", "PAN", "POL", "RUS", "SUN", "UKR", "ZAF", "ESP", "GBR", "USA", "URY", "VUT")
         ,Colour   = c("grey25", "grey60", "grey25", "grey60", "grey25", "grey60"
                      ,"grey25", "grey60", "grey25", "grey60", "grey25", "grey60"
                      ,"grey25", "grey60", "grey25", "grey60", "grey25", "grey60"
                      ,"grey25", "grey60", "grey25", "grey60", "grey25", "grey60"
                      , "grey25", "grey60")
) # end dataframe

     ############ details for reporting catch composition - BFTaxa ###########################

tCode          <- c("TOP","TOA","GRV","MCC","SRX","RAJ","ANT","WGR","GR2","RFA","GR1","ANI","NOS","BYR","LIC","SRR","NOR"
                    ,"ANS","GHP","NOG","NOT","NOX","ICX","KIF","SGI","SSI","WIC","KRI","LXX","MZZ","TRL","ELC","SQA","SPX","SQS","KCF","KCV")
Catch_Group   <- c(4,5,6,6,7,7,8,6,6,7,6,3,10,7,9,7,1
                   ,12,2,2,2,2,9,9,9,9,9,13,14,16,15,14,17,18,17,11,11)

BT_name                     <- c("Notothenia rossii"
                             ,"Other Groundfish"
                             ,"Mackerel Icefish"
                             ,"Dissostichus eleginoides"
                             ,"Dissostichus mawsoni"
                             ,"Grenadiers"
                             ,"Skates & rays"
                             ,"Antimora spp."
                             ,"Other icefish"
                             ,"Lepidonotothen squamifrons"
                             ,"Crabs"
                             ,"Silverfish"
                             ,"Krill"
                             ,"Myctophids"
                             ,"Trematomus spp."
                             ,"Unknown fish"
                             ,"Squid"
                             ,"Salps")

BFTaxa <- data.frame(Code = tCode,Catch_Group) 
Taxon_Name<-BT_name[match(BFTaxa[,"Catch_Group"],c(1:length(BT_name)))]
BFTaxa<-cbind(BFTaxa,Taxon_Name)


     ############## for distribution of catches amongst MEASO areas ##################################

Depth_intervals<-data.frame("DepthRange" = c("Groundfish","Icefish","Toothfish","Silverfish","Myctophids","Krill","Squid","Crabs","Krill481")
                           ,"Minimum"    = c(-100,-100, -600,-100,  -3000,  -1000,  -600,-100,-300)
                           ,"Maximum"    = c(-600,-700,-1800,-500,-10000,-4000,-10000,-800,-1000)
                            )# end data frame

MEASOareas<-matrix(c("AOA","Atlantic Ocean","Antarctic","48"
                    ,"AOS","Atlantic Ocean","Subantarctic","48"
                    ,"AON","Atlantic Ocean","Northern","48"
                    ,"CIA","Central Indian","Antarctic","58"
                    ,"CIS","Central Indian","Subantarctic","58" 
                    ,"CIN","Central Indian","Northern","58"
                    ,"EIA","East Indian   ","Antarctic","58"
                    ,"EIS","East Indian   ","Subantarctic","Outside"
                    ,"EIN","East Indian   ","Northern","Outside"
                    ,"EPA","East Pacific  ","Antarctic","48"
                    ,"EPS","East Pacific  ","Subantarctic","48"
                    ,"EPN","East Pacific  ","Northern","Outside"
                    ,"WPA","West Pacific  ","Antarctic","88"
                    ,"WPS","West Pacific  ","Subantarctic","Outside"
                    ,"WPN","West Pacific  ","Northern","Outside"
                    ,"Outside","not in MEASO area","",""),byrow=TRUE,ncol=4)
dimnames(MEASOareas)[[2]]<-c("Code","Sector","Zone","CSB_Stat_Area")



decade<-seq(1960,2010,10)


################# General utility functions #####################

     ######################## for summarising catch given factors ####################
fnCatch_summary<-function(fLevel,dCSB,f,BFTaxa,Threshold){

     fn<-length(f)
     rInclude<-apply(dCSB[,f],1,function(f,fn,fLevel){res<-f %in% fLevel;if      (sum(res)<fn) return(FALSE) else return(TRUE)},fn,fLevel)

     df1<-dCSB[rInclude,c("Calendar_Year","Catch_TXN_Code","Green_Weight")]
     ByList<-lapply(c("Calendar_Year","Catch_TXN_Code"),function(f,df){return     (df[,f])},df1)

     df2<-aggregate(df1[,"Green_Weight"],by=ByList,sum)
       dimnames(df2)[[2]]<-c("Year","Taxon","Tonnes")
  
       df3<-df2[df2[,"Tonnes"]>Threshold,]
       if(nrow(df3)>0){
       df4<-aggregate(df3[,"Tonnes"],by=list(df3[,"Taxon"]),sum)
       dimnames(df4)[[2]]<-c("Taxon","Tonnes")
  
       df5<-data.frame(TaxaGroup =
               BFTaxa[match(df4[,"Taxon"],BFTaxa[,"Code"]),"Catch_Group"]
              ,Tonnes = df4[,"Tonnes"])
       df6<-aggregate(df5[,"Tonnes"],list(df5[,"TaxaGroup"]),sum)  
       dimnames(df6)[[2]]<-c("TaxaGroup","Tonnes")  
       df7<-df6[order(df6[,"Tonnes"], decreasing=TRUE),]
       df7[,"Taxon"]<-BFTaxa[match(df7[,"TaxaGroup"],BFTaxa[,"Catch_Group"])
                            ,"Taxon_Name"]

       } else df7<-NULL # end if nrow(df3)>0

     cat("Catch summary for factors (",paste(f,collapse=", "),") with combined levels: ",paste(fLevel,collapse=", "),"\n\n",sep="")   
  
      if (!is.null(df7)) print.data.frame(df7[,c(3,2)]) else 
                print("Catches lower than threshold")
      cat("\n",sep="") 

     } # end catch_summary


     ######################## for distributing catch amongst MEASO areas ####################
fnDepthArea<-function(dInt          # which depth interval
                     ,dfDepths      # data frame of depth intervals  
                     ,Cb_dat        # dataframe with "Depth", "Area" 
                                   #  optional for none, one or both of "MEASO", "ASD"
                     ){
# find grouping variables (if any)
  Groups<-dimnames(Cb_dat)[[2]] 
  Groups<-Groups[which(Groups %in% c("MEASO","ASD"))]
# subset data from depth range
    x<- Cb_dat[(Cb_dat[,"Depth"] <   dfDepths[dInt,"Minimum"] & 
                Cb_dat[,"Depth"] >=  dfDepths[dInt,"Maximum"]),]
  if(length(Groups)>0) {
           GroupBy<-lapply(Groups,function(grp,x1){return(x1[,grp])},x)
           res <- aggregate(x[,"Area"],GroupBy,sum)
         
           names(res)<-c(Groups,"Area")
            res<-data.frame(res[,Groups],rep(dfDepths[dInt,"DepthRange"],nrow(res)),res[,"Area"])
           dimnames(res)[[2]]<-c(Groups,"DepthRange","Area")
           return(res)
       } else {
           sumx<-data.frame(DepthRange = dfDepths[dInt,"DepthRange"], Area = sum(x[,"Area"]))
           return(sumx) 
       } # end else
     } # end fnDepthArea


```

# Introduction  
  
MEASO has a number of chapters that refer to, or detail, the nature and scale of fisheries over time.  The aim of this vignette is to describe the history of fisheries in the Southern Ocean and how that history varies between MEASO areas.  Section 2 details finfish and krill fisheries in the Southern Ocean.  Sections 3 and 4 detail catches of whales and seals respectively.  Incidental mortality of seabirds is considered separately to Southern Ocean fisheries because of the mortality of Southern Ocean seabirds throughout the Southern Hemisphere. This is documented in Section 5.  
   
# Finfish and krill fisheries   
  
CCAMLR provides the main source of information on finfish and krill fisheries through various reports & publications (www.ccamlr.org), although other sources are useful for clarifying the locations and scale of catches prior to the establishment of CCAMLR in 1980 [e.g. @RN49] and for the scale of incidental mortality of Southern Ocean seabirds in longline fisheries in the Southern Hemisphere (www.acap.aq).  
  
Here I use catch and effort data available in the CCAMLR Statistical Bulletin (https://www.ccamlr.org/en/publications/statistical-bulletin) as the primary source of data (hereafter referred to as CSB data or Bulletin data). 

After securing permission from data owners, the CCAMLR Secretariat extracted catch and effort data by MEASO areas. These data were originally  submitted as haul data, with geolocation of catches.  However, the dataset as a whole is not inclusive of all data in the Statistical Bulletin.  They are used to help partition the data in the Statistical Bulletin as appropriate. Hereafter, they are referred to as Haul Data.
  
The reason for the discrepancy is that early data were not required to be submitted with haul information and, instead, were simply summaries of catch and effort by CCAMLR reporting areas - Statistical Areas, Subareas or Divisions (hereafter referred to ASD areas). The scale of aggregation of submitted data varied between reporting nation.  Even since the requirement for reporting by haul, there remains discrepancies between the aggregated Bulletin Data and aggregated Haul Data.  These discrepancies are reported here.
  
The attributes of the Bulletin dataset and the relationship between the ASD areas and the MEASO areas are provided in the first subsection.  The second subsection summarises the overall attributes of the fisheries in the CCAMLR area.  The third subsection describes how the Bulletin data were subdivided into MEASO areas.  This section describes the haul dataset and its differences with the Bulletin dataset.  The fourth subsection then summarises the attributes of the fisheries relevant for considering the effects of fishing on Southern Ocean ecosystems.
  
  
## Relating data in the CCAMLR Statistical Bulletin to MEASO areas  
  
### CCAMLR Statistical Bulletin  
  
The CCAMLR Statistical Bulletin 2019 contains catch and effort records for fisheries up to the 2017-2018 split year. It comprised separate catch and effort files, along with files containing data on each of the factors.    
    
Each of the variables in the CCAMLR Statistical Bulletin (CSB) tables are described here along with a printout of the levels in each.

**AFC_ID**  Unique identifier for AGGREGATED FISHERY CATCH (system generated)[this identifier is in catch table but not included in the effort table]  

**AFE_ID** Unique identifier for the related record in AGGREGATED FISHERY EFFORT (system generated)[this identifier is in both catch data and effort data and used to link the two tables] 

**Flag_CTY_Code**  ISO 3 code for the flag of the fishing vessel(s).[in both catch and effort tables]  

**Calendar_Year**  Calendar year (YYYY) when fishing occurred.[in both catch and effort tables]  

**Month**  Month (MM) when fishing occurred.[in both catch and effort tables]  

**GAR_Code**  Geographic area code for the statistical area, subarea or division where fishing occurred. [in both catch and effort tables]  

**Target_TXN_Code**  3 alpha code for target taxon.[in both catch and effort tables]  

**GTY_Code**  Code for the gear used during fishing.[in both catch and effort tables]  

**FAC_Code**  Code for the fishing activity.[in both catch and effort tables]  

**VSZ_Code**  Code for the size category of fishing vessels based on gross tonnage.[in both catch and effort tables]  

**Catch_TXN_Code**  3 alpha code for each taxon caught.[only in catch table]  

**Green_Weight**  Green weight (tonne) of the catch.[only in catch table]  

**Fishing_Hours**  Total number of hours of fishing.[only in effort table]  

**Fishing_Days**  Total number of days during which fishing occurred.[only in effort table]  

**Vessel_Count**  Total number of vessels fishing.[only in effort table]  

**Haul_Count**  Total number of hauls made during fishing.[only in effort table]  

**Hook_Count**  Total number of hooks set. Applies to longline fishing only.[only in effort table]  

**Pot_Count**  Total number of pots set. Applies to pot fishing only.[only in effort table]  
  
  
Additional factors added to each record from the Bulletin:  
  
**Split_Year**  FAO reporting, 1 July to 30 June, with year identified for June.  
  
**CC_Season**  CCAMLR Season, 1 December to 30 November, with year identified for November.  
  
```{r ,echo=FALSE}
# CSBdata is the main data frame with catch records

CC_Season<-CSBdata[,"Calendar_Year"]
NextYear<-!is.na(CSBdata[,"Month"]) & CSBdata[,"Month"]>11
CC_Season[NextYear]<-CC_Season[NextYear]+1
Split_Year<-CSBdata[,"Calendar_Year"]
NextYear<-!is.na(CSBdata[,"Month"]) & CSBdata[,"Month"]>6
Split_Year[NextYear]<-Split_Year[NextYear]+1
CSBdata<-cbind(CSBdata,CC_Season,Split_Year)


########################################################################
# modify records to enable use of rules to assign catches to MEASO areas

# NOTE - IF RECORDS ARE MODIFIED TO CHANGE GROUP - MAKE CHANGES IN "B-M Step1.CSV" OR "B-M Step2.CSV" AS REQUIRED 
#        ALSO ADD RECORDS APPROPRIATE FOR ASSIGNING RULES TO DISTRIBUTE CATCHES

########
# Case 1: SUN catch in Area 58 in years 1978, 1979.  Has Antarctic krill and Subantarctic fish species. Reassign krill to 
# midwater trawl (not bottom trawl) and krill fishery rather than groundfish fishery

dfSelect <- (CSBdata[,"Flag_CTY_Code"]=="SUN" 
          & CSBdata[,"GAR_Code"]=="58" 
          & (CSBdata[,"Calendar_Year"]=="1978" | CSBdata[,"Calendar_Year"]=="1979")
          & CSBdata[,"Catch_TXN_Code"]== "KRI")
CSBdata[dfSelect,"Target_TXN_Code"] <- "KRI"  # for krill fishery


# Added records to "B-M Step2.csv"  :  
#            OT  SUN  6  58  1978  M
#            OT  SUN  6  58  1979  M


```


### Relationship of CCAMLR areas to MEASO areas  
  
The northern limit of the CCAMLR Convention area more or less follows the path of the Polar Front.  The MEASO Subantarctic Zone extends from the Subantarctic Front to the Southern ACC Front, between which lies the Polar Front.  Apart from the Indian Sector, the Northern Zone of the MEASO is not of importance to CCAMLR.  In the Indian Sector, CCAMLR's Subarea 58.7 overlaps with the Norther Zone because that subarea encompasses the Prince Edward and Marion Islands and most of the Delcano Rise.  
  
The MEASO and CCAMLR areas are shown with their naming conventions in Figure \@ref(fig:CCAMLR-MEASO-areas).  
  
  
```{r CCAMLR-MEASO-areas, out.width="40%", fig.cap="*CCAMLR statistical reporting areas (left) and MEASO areas (right - red lines indicate zones, black dashed lines indicate sectors)*", fig.show="hold", fig.align='center', echo=FALSE}
if(printMaps) knitr::include_graphics(c("CCAMLR_areas.png","MEASO_areas.png"))
```
  
    
The MEASO areas do not perfectly align with CCAMLR areas (Figure \@ref(fig:CCAMLR-MEASO-overlay)).  



```{r CCAMLR-MEASO-overlay, out.width="70%", fig.cap="CCAMLR statistical reporting areas (blue) overlaid on the MEASO areas (red lines)", fig.align='center', echo=FALSE}
if(printMaps) knitr::include_graphics("MEASO-CCAMLR_combined_areas.png")
```

  
    
#### Area 48  
  
Area 48 has had the most fishing activity in the CCAMLR area, historically concentrated in Subareas 48.1, 48.2 and 48.3.
  
**Subarea 48.1** is split between the Atlantic sector and the East Pacific sector at the eastern tip of Joinville Island with a line crossing the Drake Passage.  The Atlantic sector includes the eastern margin of the Antarctic Peninsula and the shelf to the east of Joinville Island and around Elephant Island.  Bransfield Strait, the western margin of the Antarctic Peninsula and the South Shetland Islands are included in the East Pacific Sector.  The Atlantic sector within the subarea is wholly within the Antarctic zone.  The component of the subarea in the East Pacific Sector has parts in the Antarctic and Subantarctic Zones. Bottom trawl fishing around Joinville Island is included in the East Pacific.  Bottom trawling around Elephant Island is included in the Atlantic.  All fisheries are in the Antarctic Zone.  
  
**Subarea 48.2** is in the Atlantic sector with a slim northern margin crossing into the Subantarctic Zone.  All the fishing areas in this subarea are in the Antarctic zone.  
  
**Subarea 48.3** is in the Atlantic sector with the Southern ACC Front extending from the east of the area to the north and west before returning to the east.  The island, shelf and bank areas sit predominantly in the Subantarctic Zone.  Fishing for bentho-pelagic finfish has occurred primarily in shelf areas.  Myctophid fishing has occurred in the north of the subarea near Morris Ewing Bank.  Krill fishing occurs primarily on the northern shelf slope. All fisheries occur in the Subantarctic Zone.  Occasionally, krill fishing has been reported to occur in the Antarctic Zone [@RN13712].  
  
**Subarea 48.4** is in the Atlantic sector.  The islands and shelf areas are within the Antarctic Zone, while the northern area is in the Subantarctic Zone.  All fisheries occur in the Antarctic Zone.  
  
**Subarea 48.5** is in the Atlantic sector and wholly within the Antarctic Zone.  
  
**Subarea 48.6** is in the Atlantic sector.  The island and shelf areas in the northern part of this subarea are primarily within the Antarctic Zone, although some deeper water areas below 1000 m lie in the Subantarctic Zone.  All fisheries occur in the Antarctic Zone.  
  
    
#### Area 58   
  
Catches in Area 58 have been reported as coming from the whole area, from subareas, and from the divisions within subareas.  
  
**Subarea 58.4** is split between the Central Indian Sector and the East Indian Sector.  It also crosses the Antarctic and Subantarctic Zones.  Krill fishing is contained within the Antarctic Zone.  Finfishing has occurred in both zones, although groundfish fisheries prior to longlining primarily occurred in the Subantarctic Zone.  
  
*Division 58.4.1* crosses between the Central Indian Sector and the East Indian Sector at 115oE, and is mostly in the Antarctic Zone.  The northern part of this division is in deep water in the Subantarctic Zone.  All fisheries occur in the Antarctic Zone.  
  
*Division 58.4.2* falls within the Central Indian Sector and the Antarctic Zone.  A small deep water area in the north east of this division is in the Subantarctic Zone.  All fisheries occur in the Antarctic Zone.  
  
*Division 58.4.3a* is in the Central Indian Sector and falls almost entirely in the Subantarctic Zone.  
  
*Division 58.4.3b* is in the Central Indian Sector and falls mostly in the Subantarctic Zone. The deeper eastern margin of BANZARE Bank is in the Antarctic Zone. Finfish fisheries occur in the Subantarctic Zone.  
  
*Division 58.4.4a* is in the Central Indian Sector.  It is split between the Antarctic Zone where krill fishing occurs and the Subantarctic Zone where finfishing has occurred on the Ob seamount.  
  
*Division 58.4.4b* is in the Central Indian Sector.  It is split between the Antarctic Zone where krill fishing occurs and the Subantarctic Zone where finfishing has occurred on the Lena and other seamounts.  
  
**Subarea 58.5** contains two divisions (58.5.1, 58.5.2) and is in the Central Indian Sector, falling mostly in the Subantarctic Zone.  The deep water northeast corner of Division 58.5.1 sits in the Northern Zone. All fisheries occur within the Subantarctic Zone.  
  
**Subarea 58.6** is in the Central Indian Sector, falling mostly in the Subantarctic Zone.  The northwest corner over Delcano Rise is in the Northern Zone.  
  
**Subarea 58.7** is in the Central Indian Sector.  It is split between the Subantarctic Zone and the Northern Zone.  Most shallow water area is around the islands and shelf area in the Northern Zone. Fisheries occur in the Northern Zone.  
  
#### Area 88  
  
Early fishing interest in Area 88 was in the western margins around the Balleny Islands.  
  
**Subarea 88.1** crosses between the East Indian Sector and the West Pacific Sector at Cape Adare, and is mostly in the Antarctic Zone.  The northern part of this subarea is in deep water in the Subantarctic Zone. All fisheries occur in the Antarctic Zone.  
  
**Subarea 88.2** crosses between the West Pacific Sector and the East Pacific Sector at 125oW, and is mostly in the Antarctic Zone.  The northeast part of this subarea in the East Pacific Sector is in deep water in the Subantarctic Zone. All fisheries occur in the Antarctic Zone.  
  
**Subarea 88.3** is in the East Pacific Sector.  It is split between the Antarctic and Subantarctic Zones with shallow areas occurring almost entirely in the Antarctic Zone. All fisheries occur in the Antarctic Zone.  
  
  
## Summary of fisheries  
  
### Target Fisheries  
  
The development of Antarctic fisheries began in the 1960s with commercial quantities first being taken in 1969 by the Soviet Union. @RN6645 describes the histories of the fisheries.  He noted that the main target finfish species until publication of his book had been the bentho-pelagic Nototheniids - *Notothenia rossii*, *Lepidonothen squamifrons*, *Patagonotothen guntheri*, *Dissostichus eliginoides* - and the Channicthyds (icefish) - *Champsocephalus gunnari*, *Chaenodraco wilsoni* [which was often misreported as *C. gunnari*, @RN6645] -, and the pelagic myctophids, notably *Electrona carlsbergi*.  The other main target species at that time was Antarctic krill, *Euphausia superba*.  The only additional species to be targetted have been lithodid crabs and *D. mawsoni*.  Some exploratory fishing for the Antarctic silverfish, *PLeurogramma antarcticum*, and squid have been undertaken from time to time but these fisheries never became established.

Records are assigned in the Bulletin database to fisheries according to target species.  Some of the notothenids caught in the early trawl fisheries were grouped.  The different target species are further grouped to simply differentiate between different gears and deployment in the water column.  The groundfish fisheries had various assignments of target species and are grouped here as a 'groundfish' fishery.  The assignments are in the following table: 

```{r TargetGroups, echo=FALSE}

TargetFishery<-CSB_taxa[unique(match(CSBdata[,"Target_TXN_Code"],CSB_taxa[,"TXN_Code"])),]
TF_Plot_Order<-data.frame(TFn      = c(     3,     2,     7,     1,     6,     5,      1,    2,     1 
                                            ,    5,     1,     4,     8,     1,     2)
                         ,TXN_Code = c( "TOT", "ANI", "SQS", "MZZ", "KRI", "LXX", "NOX", "ICX", "NOG"
                                            ,"ELC", "GHP", "ANS", "KCX", "NOS", "WIC")
                         ,DepthRange = c("600-1800m", "100-700m", "Pelagic", "-", "Pelagic", "Pelagic", "0-500m", "100-650", "0-500m"
                                            ,"Pelagic", "150-350m", "0-700m", "200-1500m", "0-600m", "100-650m")
                          ) # end data frame
TF_Plot_Order<-TF_Plot_Order[order(TF_Plot_Order[,"TFn"]),]

printTF<-data.frame(Fishery    = TF_Names[match(TF_Plot_Order[,"TFn"],TF_Names[,"TFn"]),"Fishery"]
                   ,TaxonCode  = TF_Plot_Order[,"TXN_Code"]
                   ,TaxonName  = CSB_taxa[match(TF_Plot_Order[,"TXN_Code"],CSB_taxa[,"TXN_Code"]),"TXN_Name"]
                   ,Depth      = TF_Plot_Order[,"DepthRange"]
                   ) # end df
print.data.frame(printTF)

# create vector to be added to CSBdata for the Target fishery for each record

Fishery_type<-TF_Plot_Order[match(CSBdata[,"Target_TXN_Code"],TF_Plot_Order[,"TXN_Code"]),"TFn"]  # plot by number of Target Fishery to get right order 

CSBdata<-cbind(CSBdata,Fishery_type)
dimnames(CSBdata)[[2]][length(names(CSBdata))]<-"TFN"
```
  
A new factor was added to the main data frame with details in a reference data frame:

**TFN**  Fishery number assigned to the record, as per the legend sequence in Figure \@ref(fig:TargetFisheries).

Records were checked for their assignment to target fisheries based on the dominant species caught over the course of one year in that fishery, aggregated according to nominated gear types.  Records having patterns of aggregated catches that did not match the general pattern of dominant species caught were reassigned to other fisheries for which the pattern was more similar.  This only occurred for catches in the groundfish, mackerel icefish and krill fisheries in the 1970s prior to CCAMLR.

  
```{r TargetFisheries, out.width="70%", fig.cap="*Total catch (tonnes, all taxa) in each major fishery in the CCAMLR area in each decade from the 1960s to the present, derived from the CCAMLR Statistical Bulletin 2019*", fig.show='hold', fig.align='center', echo=FALSE}

# add zeros for each Fishery*Decade 

decade<-seq(1960,2010,10)
TFzeros<-do.call(rbind,lapply(seq(1,length(decade),1),function(t,decade,TFn){return(data.frame(Decade=rep(decade[t],length(TFn))
                                                                                              ,Fishery=TFn
                                                                                              ,Tonnes=rep(0,length(TFn))
                                                                                              ))},decade,TF_Names[,"TFn"]))

res1<-data.frame(Decade=10*(floor(CSBdata[,"Calendar_Year"]/10))
                ,Fishery=CSBdata[,"TFN"]
                ,Tonnes = CSBdata[,"Green_Weight"])
res1<-rbind(res1,TFzeros)
res<-as.data.frame(aggregate(res1[,"Tonnes"],list(res1[,"Decade"],res1[,"Fishery"]),sum))
dimnames(res)[[2]]<-c("Decade","Fishery","Tonnes")


plotYlog<-TRUE

if(plotYlog){
  res[res[,"Tonnes"]<1,"Tonnes"]<-1
   }

p <- ggplot()
p <- p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()
               ,panel.background = element_blank()
               , axis.line = element_line(colour = "black",size=1, linetype="solid"))

p<- p+ geom_col(res, mapping = (aes(x = factor(res[,"Decade"]), y = res[,"Tonnes"], fill = factor(res[,"Fishery"]))),position = position_dodge(preserve = 'single'))
p <- p + labs(x = "Decade", y ="Tonnes", fill = "Fishery",title="Total catch by decade for type of fishery")
if (plotYlog) p <- p + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)), limits = c(1E0,1E8)) + annotation_logticks(sides="l")
p <- p + scale_fill_discrete(name = "Fishery", breaks=levels(factor(res[,"Fishery"])),labels = TF_Names[as.character(TF_Names[,"TFn"])  %in%  levels(factor(res[,"Fishery"])),"Fishery"],type=TF_Names[,"Colour"]) # change legend labels

p

```
  
### Gear Type  
  
Gear types in the CCAMLR Statistical Bulletin have been specifically identified as bottom and midwater trawls, hooks and lines, pots and traps, squid jigging and seines.    

```{r GearTypeSetup, echo=FALSE}

plotGearTypeRaw<-FALSE
plotGearTypeRev<-TRUE
# add zeros for each Fishery*Decade 
GTzeros<-do.call(rbind,lapply(seq(1,length(decade),1),function(t,decade,GT){return(data.frame(Decade=rep(decade[t],length(GT))
                                                                                              ,Gear=GT
                                                                                              ,Tonnes=rep(0,length(GT))
                                                                                              ))},decade,GT_Names[,"GTn"]))

```

  
```{r plotGearTypeRaw, out.width="70%", fig.cap="*Total catch (tonnes, all taxa) for each major gear type in the CCAMLR area in each decade from the 1960s to the present, derived from the CCAMLR Statistical Bulletin 2019*", fig.show='hold', fig.align='center', echo=FALSE}

if(plotGearTypeRaw){
res1<-data.frame(Decade=10*(floor(CSBdata[,"Calendar_Year"]/10))
                ,Gear=GT_Names[match(CSBdata[,"GTY_Code"],GT_Names[,"Gear"]),"GTn"]
                ,Tonnes = CSBdata[,"Green_Weight"])
res1<-rbind(res1,GTzeros)
res<-as.data.frame(aggregate(res1[,"Tonnes"],list(res1[,"Decade"],res1[,"Gear"]),sum))
dimnames(res)[[2]]<-c("Decade","Gear","Tonnes")

# exclude data
GTY_exclude<- GT_Names[match(c("TX","TBB"),GT_Names[,"Gear"]),"GTn"]     
res<-res[!(res[,"Gear"] %in% GTY_exclude),]
pGT_Names<- GT_Names[-(match(GTY_exclude,GT_Names[,"GTn"])),] 

plotYlog<-TRUE

if(plotYlog){
  res[res[,"Tonnes"]<1,"Tonnes"]<-1
   }

p <- ggplot()
p <- p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()
               ,panel.background = element_blank()
               , axis.line = element_line(colour = "black",size=1, linetype="solid"))

p<- p+ geom_col(res, mapping = (aes(x = factor(res[,"Decade"]), y = res[,"Tonnes"], fill = factor(res[,"Gear"]))),position = position_dodge(preserve = 'single'))
p <- p + labs(x = "Decade", y ="Tonnes", fill = "Gear",title="Total catch by decade for gear type")
if (plotYlog) p <- p + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)), limits = c(1E0,1E8)) + annotation_logticks(sides="l")
p <- p + scale_fill_discrete(name = "Gear", breaks=levels(factor(res[,"Gear"]))
                             ,labels = CRfishingGear[match(pGT_Names[
                                            match(as.character(pGT_Names[,"GTn"]),levels(factor(res[,"Gear"])))
                                            ,"Gear"],CRfishingGear[,"GTY_Code"]),"GTY_Name"]
                             ,type=pGT_Names[,"Colour"]) # change legend labels

p
} # end if plotGearTypeRaw

```
  
Fisheries in the 1970s and 1980s were undertaken primarily using otter trawls.  While these trawls became regularly differentiated between bottom and midwater trawling since that time, those early years had a large proportion of trawling not differentiated (i.e. Otter Trawl nei).  As they comprise a large component of the early fisheries, an assessment of the potential historical effects of fishing on the ecosystem needs to assign these trawls to either bottom or midwater fishing.  A two step process was used to assign Otter Trawls Nei to either of the categories.

**Step 1**: Catches for individual taxa were aggregated using three factors - gear type, flag country, fishery.  They were initially aggregated with an additional factor, year, in order to exclude records for taxa with an annual catch less than 30 tonnes.  The data for taxa were then  aggregated across years within the combinations of the three main factors.  The pattern of relative abundance of taxa within the target fisheries and with gear type were used to check whether assignment to pelagic (midwater) or bottom fishing were likely to be correct.  For example, midwater fishing typically yielded large quantities of krill, myctophids and/or silverfish, the latter two rarely being seen in bottom trawls.  As a result of this checking, no trawls already assigned to midwater or bottom were changed.  For the unassigned otter trawls, the myctophid target fishery was assigned to midwater trawling.  The remainder were asigned to bottom trawling, except for the Groundfish and Krill target fisheries of the Soviet Union, which did not have clear catch patterns relating to either midwater or bottom fisheries (groundfish and krill were represented in equal measure).  These were further analysed in Step 2.  
  
  
```{r GTstep1,echo=FALSE}
# visual inspection of aggregation according to th

# code to check assignment of location of fishing gear - bottom or midwater fisheries - once done, this code can be turned off with logical

                      CheckBottomFishAssignments<-FALSE
                      if(CheckBottomFishAssignments){
                        Factors<-c("GTY_Code","Flag_CTY_Code","TFN")
                        LevelCombinations<-unique(CSBdata[,Factors])
                        apply(LevelCombinations,1,fnCatch_summary
                              ,CSBdata,Factors,BFTaxa,Threshold=10)
                        } # end if

# add location following inspection and creating a CSV file with relevant assignment from first step: data_Location_B_M_Step_1

dfTmp1<-merge(CSBdata,data_Location_B_M_Step_1,by=c("GTY_Code","Flag_CTY_Code","TFN"))

```
  
**Step 2**:  The Soviet Union data for unassigned otter trawls were examined by the combination of three factors - target fishery (only groundfish and krill were represented), CCAMLR catch reporting areas, and year.  For the groundfish fishery, some combinations were dominated by krill with comparatively few groundfish represented.  These were assigned to midwater trawling, with the remainder assigned to bottom fishing.
  
```{r GTstep2,echo=FALSE}
# check OT,SUN,TFN=c(1,6) in more detail as still uncertain - once done, this code can be turned off with logical

                       CheckSUN_OTassignments<-FALSE
                       if(CheckSUN_OTassignments){
                                                dfSUN<-CSBdata[CSBdata[,"GTY_Code"]=="OT" 
                                     & CSBdata[,"Flag_CTY_Code"]=="SUN"
                                     & CSBdata[,"TFN"] %in% c(1,6),]
                         Factors<-c("GTY_Code","Flag_CTY_Code","TFN","GAR_Code","Calendar_Year")
                         LevelCombinations<-unique(dfSUN[,Factors])
                         apply(LevelCombinations,1,fnCatch_summary
                               ,dfSUN,Factors,BFTaxa,Threshold=10)
                         } # end if

# modify location following inspection of SUN data for OT and creating a CSV file with relevant assignment from second step: data_Location_B_M_Step_2

dfTmp2<-merge(dfTmp1,data_Location_B_M_Step_2,by=c("GTY_Code","Flag_CTY_Code","TFN","GAR_Code","Calendar_Year"),all.x=TRUE)
dfTmp2[dfTmp2[,"Location.x"]=="U","Location.x"]<-dfTmp2[dfTmp2[,"Location.x"]=="U","Location.y"]
dimnames(dfTmp2)[[2]][dimnames(dfTmp2)[[2]]=="Location.x"]<-"Location"
CSBdata<-dfTmp2[,-which(dimnames(dfTmp2)[[2]] %in% "Location.y")]
GTY_rev<-CSBdata[,"GTY_Code"]
GTY_rev[GTY_rev=="OT"]<-unlist(lapply(CSBdata[GTY_rev=="OT","Location"],function(g){paste("OT",g,sep="")}))
CSBdata<-cbind(CSBdata,GTY_rev)

```




```{r plotGearTypeRev, out.width="70%", fig.cap="*Total catch (tonnes, all taxa) for each major gear type in the CCAMLR area in each decade from the 1960s to the present, derived from the CCAMLR Statistical Bulletin 2019 with Otter Trawl Nei assigned to bottom or midwater (see text for details))*", fig.show='hold', fig.align='center', echo=FALSE}

# plot revised assignments
if(plotGearTypeRev){
res1<-data.frame(Decade=10*(floor(CSBdata[,"Calendar_Year"]/10))
                ,Gear=GT_Names[match(CSBdata[,"GTY_rev"],GT_Names[,"Gear"]),"GTn"]
                ,Tonnes = CSBdata[,"Green_Weight"])
res1<-rbind(res1,GTzeros)
res<-as.data.frame(aggregate(res1[,"Tonnes"],list(res1[,"Decade"],res1[,"Gear"]),sum))
dimnames(res)[[2]]<-c("Decade","Gear","Tonnes")

# exclude data
GTY_exclude<- GT_Names[match(c("TX","TBB","OT"),GT_Names[,"Gear"]),"GTn"]     
res<-res[!(res[,"Gear"] %in% GTY_exclude),]
pGT_Names<- GT_Names[-(match(GTY_exclude,GT_Names[,"GTn"])),] 

plotYlog<-TRUE

if(plotYlog){
  res[res[,"Tonnes"]<1,"Tonnes"]<-1
   }

p <- ggplot()
p <- p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()
               ,panel.background = element_blank()
               , axis.line = element_line(colour = "black",size=1, linetype="solid"))

p<- p+ geom_col(res, mapping = (aes(x = factor(res[,"Decade"]), y = res[,"Tonnes"], fill = factor(res[,"Gear"]))),position = position_dodge(preserve = 'single'))
p <- p + labs(x = "Decade", y ="Tonnes", fill = "Gear",title="Total catch by decade for gear type with assigned OT")
if (plotYlog) p <- p + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)), limits = c(1E0,1E8)) + annotation_logticks(sides="l")
p <- p + scale_fill_discrete(name = "Gear", breaks=levels(factor(res[,"Gear"]))
                             ,labels = CRfishingGear[match(pGT_Names[
                                            match(as.character(pGT_Names[,"GTn"]),levels(factor(res[,"Gear"])))
                                            ,"Gear"],CRfishingGear[,"GTY_Code"]),"GTY_Name"]
                             ,type=pGT_Names[,"Colour"]) # change legend labels

p
} # end if plotGearTypeRev

```
  

A revised GTY code is added to the main data frame along with an assignment of all fisheries to a location in the water column in which the gear was deployed:

**GTY_rev**    Revised GTY_Code to replace OT code  
**Location**   Gear deployed on or near to the bottom (B) or midwater (M).  
  
  
    
### Nations

```{r NationsSetup, echo=FALSE}

                      CheckSUN_OTassignments<-FALSE
                       if(CheckSUN_OTassignments){
                                dfSUN<-CSBdata[CSBdata[,"Flag_CTY_Code"]=="SUN" &
                                               (CSBdata[,"GAR_Code"]=="48"),]
                         Factors<-c("GTY_Code","TFN","GAR_Code","Split_Year")
                         LevelCombinations<-unique(dfSUN[,Factors])
                         apply(LevelCombinations,1,fnCatch_summary
                               ,dfSUN,Factors,BFTaxa,Threshold=2)
                         } # end if

CheckStatAreaAssignments<-FALSE
if(CheckStatAreaAssignments){
dfcombo<-CSBdata[,] # CSBdata[,"GAR_Code"] %in% c("48","58","88")
  Factors<-c("GTY_Code","GTY_rev","Flag_CTY_Code","TFN","GAR_Code","Split_Year")
  LevelCombinations<-unique(dfcombo[,Factors])
  apply(LevelCombinations,1,fnCatch_summary
        ,dfcombo,Factors,BFTaxa,Threshold=10)
  } # end if



##################################################################################################
tempContinue<-FALSE

if(tempContinue){

# check catches by species
  
cat("Total catch of individual tax (where a catch in one year by a nation of the taxon :",sep="")
     
  df<-aggregate(df2[,"Tonnes"],by=list(df2[,"Nation"]),sum)
  dimnames(df)[[2]]<-c("Nation","Tonnes")


  
  
# determine first and last years
  
  TrawlGfish_CTY<-df[,"Nation"]
  YearFirst<-unlist(do.call(rbind,lapply(TrawlGfish_CTY,function(c,dCSB){min(dCSB[dCSB[,"Nation"]==c,"Year"])},df2)))
  YearLast <-unlist(do.call(rbind,lapply(TrawlGfish_CTY,function(c,dCSB){max(dCSB[dCSB[,"Nation"]==c,"Year"])},df2)))
df<-cbind(df,YearFirst,YearLast)



# add zeros for each Nation*Decade 

decade<-seq(1960,2010,10)
CTzeros<-do.call(rbind,lapply(seq(1,length(decade),1),function(t,decade,CT){return(data.frame(Decade=rep(decade[t],length(CT))
                                                                                              ,Country=CT
                                                                                              ,Tonnes=rep(0,length(CT))
                                                                                              ))},decade,CT_Names[,"CTn"]))


res1<-data.frame(Decade=10*(floor(CSBdata[,"Calendar_Year"]/10))
                ,Gear=GT_Names[match(CSBdata[,"GTY_Code"],GT_Names[,"Gear"]),"GTn"]
                ,Tonnes = CSBdata[,"Green_Weight"])
res1<-rbind(res1,GTzeros)
res<-as.data.frame(aggregate(res1[,"Tonnes"],list(res1[,"Decade"],res1[,"Gear"]),sum))
dimnames(res)[[2]]<-c("Decade","Gear","Tonnes")




  
  
  p <- ggplot(df, aes(x = factor(df[,"Nation"]), y = df[,"Tonnes"], fill = factor(df[,"Country"])))
  p <- p + geom_col(position = "dodge")
  p <- p + labs(x = "Gear", y ="Tonnes", fill = "Country",title=paste(CatchTaxon[ct]," catch by gear for countries",sep=""))
  p<-p + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)), limits = c(1E0,1E8)) + annotation_logticks(sides="l")
  p <- p + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()
               ,panel.background = element_blank()
               , axis.line = element_line(colour = "black",size=1, linetype="solid"))
  p
  
 plots<- c(plots,list(p))
 
} # end tempContinue



```

#### Bentho-pelagic fisheries**  
  
  
#### Pelagic fisheries**  
  

## Dividing CCAMLR data into MEASO reporting areas  


```{r DCprepare,echo=FALSE}

# some routines for summarising data

CheckRecords<-FALSE
if(CheckRecords){
dfcombo<-CSBdata[CSBdata[,"Catch_TXN_Code"] %in% c("WIC"),]
  Factors<-c("Flag_CTY_Code","GAR_Code")
  LevelCombinations<-unique(dfcombo[,Factors])
  apply(LevelCombinations,1,fnCatch_summary
        ,dfcombo,Factors,BFTaxa,Threshold=10)
  } # end if


CheckStatAreaAssignments<-FALSE
if(CheckStatAreaAssignments){
dfArea<-CSBdata[CSBdata[,"GAR_Code"] %in% c("48","58","88"),]
  Factors<-c("GTY_Code","Flag_CTY_Code","TFN","GAR_Code","Calendar_Year")
  LevelCombinations<-unique(dfWholeStatArea[,Factors])
  apply(LevelCombinations,1,fnCatch_summary
        ,dfWholeStatArea,Factors,BFTaxa,Threshold=10)
  } # end if


```

Catch records in the Bulletin were reviewed by split year and grouped by ASD area, Flag Country, Gear type (revised as above), Fishery, and Taxa with annual catches by country greater than 10 tonnes (assumed to relate to commercial quantities of groundfish or toothfish).  

Fisheries since 1990 are well described in CCAMLR reports, particularly fishery reports for toothfish, mackerel icefish and Antarctic krill (http://fisheryreports.ccamlr.org/).  Catch reports that were aggregated across a number of ASD areas prior to 1990 had their the last year of reports as follows:

  - only by Statistical Areas 48 (Atlantic), 58 (Indian), and 88 (Pacific) by the main fishing nations were the split-years 1986, 1979, 1986 respectively. Latvia had a single reported fishing year for a low catch of krill in Area 48 in 1993.
  - only by Subarea 58.4 and 58.5 ended in 1987 and 1988 respectively
  - only by 58.4.3 and 58.4.4, ended by 1999 and 1980 respectively.
  
  
```{r CatchDistSetup, echo=FALSE}
Seabed_areas <- readRDS(Seabed_file)
# give each cell an area of 2x2 km until it is available in input file
Seabed_areas<-cbind(Seabed_areas,rep(4,nrow(Seabed_areas)))

# rename variables to be consistent with code
dimnames(Seabed_areas)[[2]]<-c("Lon","Lat","Cell","Depth","Iceshelf","MEASO","ASD","SSRU","SSMU","Area")

Cbed_rules<-Seabed_areas[!(Seabed_areas[,"Iceshelf"]) & !is.na(Seabed_areas[,"ASD"]) & !is.na(Seabed_areas[,"MEASO"]),c("Lon","Lat","Depth","MEASO","ASD","SSMU","SSRU","Area")]
Cbed_rules[is.na(Cbed_rules[,"SSRU"]),"SSRU"]<-"NA"
Cbed_rules[is.na(Cbed_rules[,"SSMU"]),"SSMU"]<-"NA"


fnPropInMareaForRule<-function(cbed_a,M_areas,FixedProp=FALSE){   # if FixedProp then the areas in cbed_a are proportions
     res<-rep(0,length(M_areas))
     if(FixedProp) x<-cbed_a[,"Area"] else x<-cbed_a[,"Area"]/sum(cbed_a[,"Area"])
     res[match(cbed_a[,"MEASO"],M_areas)]<-round(x,3)
     names(res)<-M_areas
     return(res)
     } # end fnPropInMarea

```

## Area 48

Old Text

Early bottom fisheries in this area spread across Subareas 48.1, 48.2 and 48.3.  For the most part, trawl fisheries were identified to be concentrated from 100-600 m in depth.  Longline fisheries occur in 600m to 1800m in depth.  
  
In Subarea 48.1, @RN6645 shows the trawl fisheries concentrated on the shelf to the north west of the South Shetland Islands, and to the northeast of Joinville Island.  The fishing grounds around the SSI are approximated by the CCAMLR Small-scale Management Units (SSMUs) of Drake Passage West, Drake Passage East, and Elephant Island.  The grounds around Joinville Island are in the eastern margins of two SSMUs - Bransfield Strait East and Antarctic Peninsula East.  The fishing grounds were approximated to be in the area to the north and east of Joinville Island within these SSMUs and bounded to the west by the meridian 56oW and to the south by the latitude 63.3S.  
  
In Subarea 48.2, @RN6645 shows the trawl fisheries were in areas corresponding to two SSMUs - South Orkney West and South Orkney North East.  
  
In Subarea 48.3, the trawl fisheries explored all available sea bed within the depth range.  
  
Without other corroborating information, these seabed areas were used to distribute the catch amongst MEASO areas when there was no other information to better locate the catch.  



----
Early bottom fisheries in this area spread across Subareas 48.1, 48.2 and 48.3.  For the most part, trawl fisheries were identified to be concentrated from 100-600 m in depth.  Longline fisheries occur in 600m to 1800m in depth.  
  
While not ideal, catches aggregated at the level of Statistical Area were assigned to subareas according to the proportions of trawlable seabed area across Subareas 48.1, 48.2 and 48.3 [@RN6645].  
- Subarea 48.1, @RN6645 shows the trawl fisheries concentrated on the shelf to the north west of the South Shetland Islands, and to the northeast of Joinville Island.  The fishing grounds around the SSI are approximated by the CCAMLR Small-scale Management Units (SSMUs) of Drake Passage West, Drake Passage East, and Elephant Island.  The grounds around Joinville Island are in the eastern margins of two SSMUs - Bransfield Strait East and Antarctic Peninsula East.  The fishing grounds were approximated to be in the area to the north and east of Joinville Island within these SSMUs and bounded to the west by the meridian 56oW and to the south by the latitude 63.3S.  
- Subarea 48.2, @RN6645 shows the trawl fisheries were in areas corresponding to two SSMUs - South Orkney West and South Orkney North East.  
- Subarea 48.3, the trawl fisheries explored all available sea bed within the depth range.  
  
Fishing grounds in Subareas 48.2 and 48.3 fall within the Antarctic Zone and Subantarctic Zones respectively in the Atlantic Ocean sector.  Subarea 48.1 was separated into the Atlantic and East Pacific Sectors of the Antarctic Zone according to the locations of trawlable seabed in that area.  
  
For longline fisheries, the following considerations applied:  
- Chilean pot fishing research in 1998 is listed as a longline fishery in the Bulletin data.  It was concentrated in Subarea 48.1 around Elephant Island and the South Shetland Islands.  The SSMUs in these areas, as for trawl fishing, were used but with the depth range for longline fishing to calculate the proportion of area in each sector.  
- Subarea 48.6 was divided into northern and southern fisheries at 60oS.  This Subarea primarily falls in the Antarctic Zone of the Atlantic Sector.  Catches were assumed to be in the Antarctic Zone. 


Krill fishing in the 1970s occurred in Areas 48 and 58.  During this period, the Soviet Union fishing vessels would fish for krill if the catches of finfish were poor [@RN6645]. In order to distribute the catch by the Soviet Union attributed to Area 48, the spatial pattern adopted for bottom fishing was adopted here, with the proportion of catches in the different MEASO areas determined by seabed areas for krill fishing in SSMUs in Subarea 48.1 (APDPW, APDPE, APEI, and the northeast part of APBSE), Subarea 48.2 (SOW,SONE) and depths in Subarea 48.3. The depth range of 300-1000 m was approximated from the analyses in @RN13713

Distribution of midwater catches between MEASO areas was only ambiguous for Subarea 48.1.  Given the expansion of interest in krill fishing, catches were distributed between the East Pacific Antarctic area from the Atlantic Antarctic area according to the distribution of the depth strata.

While krill fisheries concentrated near to South Georgia.  Myctophid fisheries were attempted in the northern part of Subarea 48.3, the area of which was surveyed in the late 1980s [@RN4306].  Both these fisheries occur in the Subantarctic Zone.


  
```{r CD_Area48, echo=FALSE}
CatchDistRules<-NULL

############################
# General distribution rules
############################
##############################################################################################
RuleName        <- "48N00_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 48.2- all fishing - Atlantic Antarctic area"
RuleSubset <- (  ( CSBdata[,"GAR_Code"] == "482"  
                 | CSBdata[,"GAR_Code"] == "484"  
                 | CSBdata[,"GAR_Code"] == "485"  
                 | CSBdata[,"GAR_Code"] == "486"
                 )
    #          & CSBdata[,"GTY_rev"]      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("AOA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


##############################################################################################
RuleName        <- "48N00_S"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 48.3- all fishing - Atlantic Subantarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "483"
    #          & CSBdata[,"GTY_rev"]      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("AOS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


################
# Bottom fishing
################
##############################################################################################
RuleName        <- "48B0T"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Area 48-trawl-SUN-all of Area 48"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "48"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
  #            & CSBdata[,"TFN"]          == 1
  #            & CSBdata[,"Split_Year"]   == 1986
              ) # end RuleSubset

# subset data to include only Subareas 48.1, 48.2 and 48.3 and relevant SSMUs

dfR <- Cbed_rules[
          (Cbed_rules[,"ASD"]=="48.1" & 
              (     (    Cbed_rules[,"SSMU"]=="APBSE" 
                       & Cbed_rules[,"Lon"]>-56 
                       & Cbed_rules[,"Lat"]>-63.3)
                  | (    Cbed_rules[,"SSMU"]=="APE"   
                       & Cbed_rules[,"Lon"]>-56
                       & Cbed_rules[,"Lat"]>-63.3) 
               ) 
              |  Cbed_rules[,"SSMU"]=="APDPW" 
              |  Cbed_rules[,"SSMU"]=="APDPE" 
              |  Cbed_rules[,"SSMU"]=="APEI"   )
      |   (Cbed_rules[,"ASD"]=="48.2" & 
               ( Cbed_rules[,"SSMU"]=="SOW" 
              |  Cbed_rules[,"SSMU"]=="SONE"))| 
           Cbed_rules[,"ASD"]=="48.3"
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "48B1L"
TypeDepthInterval<-3 # row of data frame Depth_intervals

RuleDescription <- "Subarea 48.1-longline-Chile - WG-FSA-98/20 - South Shetlands." # was really pots but sticking with the Bulletin here.
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "481"
               & CSBdata[,"GTY_rev"]      == "LLS"
               & CSBdata[,"Flag_CTY_Code"]== "CHL"
  #            & CSBdata[,"TFN"]          == 3
  #            & CSBdata[,"Split_Year"]   == 1998
              ) # end RuleSubset

# subset data to include only Subareas 48.1, 48.2 and 48.3 and relevant SSMUs

dfR <- Cbed_rules[
           Cbed_rules[,"ASD"]=="48.1" & 
              (  Cbed_rules[,"SSMU"]=="APDPW" 
              |  Cbed_rules[,"SSMU"]=="APDPE" 
              |  Cbed_rules[,"SSMU"]=="APEI"   )
          ,]
 

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


##############################################################################################
RuleName        <- "48B1T"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Subarea 48.1-trawl-spread around finfishing grounds according to Kock, 1992."
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "481"
               & CSBdata[,"GTY_rev"]      == "OTB"
  #            & CSBdata[,"Flag_CTY_Code"]
  #            & CSBdata[,"TFN"]         
  #            & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

# subset data to include only Subareas 48.1, 48.2 and 48.3 and relevant SSMUs

dfR <- Cbed_rules[
          (Cbed_rules[,"ASD"]=="48.1" & 
                  ( (Cbed_rules[,"SSMU"]=="APBSE" & Cbed_rules[,"Lon"]>-56 & Cbed_rules[,"Lat"]>-63.3) |
                    (Cbed_rules[,"SSMU"]=="APE"   & Cbed_rules[,"Lon"]>-56 & Cbed_rules[,"Lat"]>-63.3) ) | 
                  Cbed_rules[,"SSMU"]=="APDPW" | 
                  Cbed_rules[,"SSMU"]=="APDPE" | 
                  Cbed_rules[,"SSMU"]=="APEI"   )
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##################
# Midwater fishing
##################
##############################################################################################
RuleName        <- "48M0T"
TypeDepthInterval<-6 # row of data frame Depth_intervals

RuleDescription <- "Area 48-trawl-SUN-all of Area 48 - based on B01"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "48"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & ( CSBdata[,"Flag_CTY_Code"]== "SUN" | CSBdata[,"Flag_CTY_Code"]== "LVA")
  #            & CSBdata[,"TFN"]          == 1 | CSBdata[,"TFN"] == 6)
  #            & CSBdata[,"Split_Year"]   <= 1978  and Latvia in 1993
              ) # end RuleSubset

# subset data to include only Subareas 48.1, 48.2 and 48.3 and relevant SSMUs

dfR <- Cbed_rules[
          (Cbed_rules[,"ASD"]=="48.1" & 
              (     (    Cbed_rules[,"SSMU"]=="APBSE" 
                       & Cbed_rules[,"Lon"]>-56 
                       & Cbed_rules[,"Lat"]>-63.3)
                  | (    Cbed_rules[,"SSMU"]=="APE"   
                       & Cbed_rules[,"Lon"]>-56
                       & Cbed_rules[,"Lat"]>-63.3) 
               ) 
              |  Cbed_rules[,"SSMU"]=="APDPW" 
              |  Cbed_rules[,"SSMU"]=="APDPE" 
              |  Cbed_rules[,"SSMU"]=="APEI"   )
      |   (Cbed_rules[,"ASD"]=="48.2" & 
               ( Cbed_rules[,"SSMU"]=="SOW" 
              |  Cbed_rules[,"SSMU"]=="SONE"))| 
           Cbed_rules[,"ASD"]=="48.3"
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "48M1T"
TypeDepthInterval<-9 # row of data frame Depth_intervals - for krill in 481 after 

RuleDescription <- "Subarea 48.1-trawl-  less eastern areas south of latitude of Joinville Island."
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "481"
               & ( CSBdata[,"GTY_rev"]      == "OTM" | CSBdata[,"GTY_rev"] == "TM" | CSBdata[,"GTY_rev"] == "TMB")
  #            & CSBdata[,"Flag_CTY_Code"]
  #            & CSBdata[,"TFN"]         
  #            & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

# subset data to include only Subareas 48.1, 48.2 and 48.3 and relevant SSMUs

dfR <- Cbed_rules[
          (Cbed_rules[,"ASD"]=="48.1"  
             
             & !(    Cbed_rules[,"SSMU"]=="APE" # Antarctic Peninsula East 
                       & Cbed_rules[,"Lat"] < -63.3)
           
             &!(    Cbed_rules[,"SSMU"]=="APPA" # Antarctic Peninsula Pelagic Area  
                       & Cbed_rules[,"Lon"] > -57
                       & Cbed_rules[,"Lat"] < -63.3) 
               ) 
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


############################
# Display results
############################

print.data.frame(data.frame(Rule = names(CatchDistRules),bind_rows(lapply(CatchDistRules,function(cd){cd$Distribution}))))

CD_Area48<-CatchDistRules
```
  

**B01: Area 48 bottom trawl**  

The distribution of catch amongst MEASO areas for this rule is

    ASD: MEASO areas with proportions greater than 0

This applied to the following records:

    Country, split year, catch

  
**B02: Subarea 48.1 bottom trawl**  
  
The distribution of catch amongst MEASO areas for this rule is

    ASD: MEASO areas with proportions greater than 0

This applied to the following records:

    Country, split year, catch
  
  
**B03: Subarea 48.1 longline**  

The distribution of catch amongst MEASO areas for this rule is

    ASD: MEASO areas with proportions greater than 0

This applied to the following records:

    Country, split year, catch
    


### Area 58

@RN6645 describes the early fisheries in the Indian Sector as being dominated by finfish fishing in the Subantarctic Zone, primarily around Kerguelen Islands and Ob and Lena Banks.  Krill fishing also occurred in the Antarctic Zone in Prydz Bay.  While some fishing occurred on *Chaenodraco wilsoni* in the Antarctic Zone, which may have occurred in Divisions 58.4.1 and 58.4.2, the main fisheries occurred in the Central Indian Sector.  
  
Records containing both Antarctic krill and the finfish taxa from the Subantarctic Zone need to be separated between the zones rather than distributing each of the taxa between zones.  These records were duplicated by removing Antarctic krill and other taxa that were from the Antarctic Zone from the main record and then creating a record for the Antarctic Zone taxa.  The distribution rules for each of these adjusted records were to allocate the whole catch to their respective zones.  
  
For longline fisheries, Division 58.4.1 is the only ASD area which crosses two sectors.  The longline fishery is wholly within the Antarctic Zone.  Until recently, longline fisheries in this division were constrained to three Small-scale research units - 5841C, 5841E, 5841G.  5841A was open also but comprised only a few seamounts.  Relative proportions of seabed area across these SSRUs in the two sectors is used to divide the catch.  
  
  
```{r CD_Area58, echo=FALSE}
CatchDistRules<-NULL

############################
# General distribution rules
############################

##############################################################################################
RuleName        <- "58N00_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.2 - all fishing - Central Indian Antarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "5842"  
    #          & CSBdata[,"GTY_rev"]      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58N00_S"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subareas 58.5 & 58.6 and recent designations - all fishing - Central Indian Subantarctic area"
RuleSubset <- (  ( CSBdata[,"GAR_Code"] == "585"  
                 | CSBdata[,"GAR_Code"] == "5851"  
                 | CSBdata[,"GAR_Code"] == "5852"  
                 | CSBdata[,"GAR_Code"] == "586"
                 | CSBdata[,"GAR_Code"] == "5843a"
                 | CSBdata[,"GAR_Code"] == "5843b"
                 | CSBdata[,"GAR_Code"] == "5844a"
                 | CSBdata[,"GAR_Code"] == "5844b"
                 )
    #          & CSBdata[,"GTY_rev"]      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58N00_N"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subareas 58.7 - all fishing - Central Indian Northern area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "587"  
    #          & CSBdata[,"GTY_rev"]      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIN"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName



################
# Bottom fishing
################
##############################################################################################
RuleName        <- "58B0T_S"
TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Area 58-trawl-SUN-finfish-concentrated in subantarctic areas. No record of 58.7"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "58"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
               & CSBdata[,"TFN"]          == 1
               & CSBdata[,"Split_Year"]   < 1978
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B0T_Sa"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Area 58-trawl-SUN-subantarctci finfish (inspected data) but with Antarctic krill in 1978 & 1979" # adjust effort
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "58"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
               & CSBdata[,"TFN"]          == 1
               & ( CSBdata[,"Split_Year"]   == 1978 | CSBdata[,"Split_Year"]   == 1979 )
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIS"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B41L"
TypeDepthInterval<-3 # row of data frame Depth_intervals

RuleDescription <- "Division 58.4.1-longline-sea ice made fishing variable in location across SSRUs" 
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "LLS"
               & !(CSBdata[,"Flag_CTY_Code"]== "NZL")
        #       & CSBdata[,"TFN"]          == 6
        #       & CSBdata[,"Split_Year"]   == 1980
              ) # end RuleSubset

dfR <- Cbed_rules[
          (  Cbed_rules[,"ASD"]=="58.4.1" 
           & (  Cbed_rules[,"SSRU"]=="5841C" 
              | Cbed_rules[,"SSRU"]=="5841E"  
              | Cbed_rules[,"SSRU"]=="5841G"
              )
           )
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B41L_EI"
TypeDepthInterval<-3 # row of data frame Depth_intervals

RuleDescription <- "Area 58.4.1-longline-NZ- work close to Ross Sea"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "LLS"
               & CSBdata[,"Flag_CTY_Code"]== "NZL"
        #       & CSBdata[,"TFN"]          == 6
        #       & CSBdata[,"Split_Year"]   == 1980
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("EIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B41T_CI"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Area 58.4.1-trawl-Aus- south of BANZARE Bank"  
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & !(CSBdata[,"Flag_CTY_Code"]== "AUS")
        #       & CSBdata[,"TFN"]          == 6
        #       & CSBdata[,"Split_Year"]   == 1980
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B43_S"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.3 - all fishing - Central Indian Subantarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "5843"  
               & (CSBdata[,"GTY_rev"]  == "OTB" | CSBdata[,"GTY_rev"]  == "OTM" )     
               & CSBdata[,"Flag_CTY_Code"] == "AUS"
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName



##############################################################################################
RuleName        <- "58B44_S"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.4 - Japan bottom trawling - Central Indian Subantarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "5844"  
               & CSBdata[,"GTY_Code"]  == "OTB"
               & CSBdata[,"Flag_CTY_Code"] == "JPN"
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58B4T_A"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Subarea 58.4-trawl-SUN-icefish from continental shelf"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "584"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
               & CSBdata[,"TFN"]          == 1
               & ( CSBdata[,"Split_Year"]   == 1985 | CSBdata[,"Split_Year"]   == 1987 )
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


############################
# Midwater fishing
############################
##############################################################################################
RuleName        <- "58M0T"
TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Area 58-trawl-SUN-early years were in subantarctic"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "58"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
               & CSBdata[,"TFN"]          == 1
               & CSBdata[,"Split_Year"]   == 1979
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M0T_CIA"  # for replication of the records to have only krill - remove krill from other records, change GTY_rev to "OTM"

TypeDepthInterval<-6 # row of data frame Depth_intervals

RuleDescription <- "Area 58-trawl-SUN-subantarctci finfish (inspected data) but with Antarctic krill in 1978 & 1979"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "58"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
               & CSBdata[,"TFN"]          == 6
               & ( CSBdata[,"Split_Year"]   == 1978 | CSBdata[,"Split_Year"]   == 1979 )
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M41T"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.1-krill-relative areas-depth:1000-4000m" # Nicol et al 2000 @RN8348
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "JPN"
               & CSBdata[,"TFN"]          == 6
               & !( CSBdata[,"Split_Year"]   == 1976 | CSBdata[,"Split_Year"]   == 1982 | CSBdata[,"Split_Year"]   == 1984 )
             ) # end RuleSubset
dfR <- Cbed_rules[Cbed_rules[,"ASD"]=="58.4.1"
                & (Cbed_rules[,"MEASO"]=="CIA" |  Cbed_rules[,"MEASO"]=="EIA"),]  # need to not include northern banks and seamounts
  
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M41Ta"
TypeDepthInterval<-4 # row of data frame Depth_intervals (silverfish)
RuleDescription <- "Division 58.4.1-trawl-SUN likely near Prydz Bay"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN" 
               & (CSBdata[,"Split_Year"]==1983 | CSBdata[,"Split_Year"]==1984)
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M41Tb"
TypeDepthInterval<-6 # row of data frame Depth_intervals (krill)
RuleDescription <- "Division 58.4.1-trawl-SUN likely near Prydz Bay"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN" 
               & CSBdata[,"Split_Year"]==1990
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M41T_CI"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.1-krill-Japan-in CIA as activities in west of division."
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "JPN" 
               & CSBdata[,"Split_Year"]==1976
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M41T_EI"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.1-krill-Japan-in EIA as activities in East of division."
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "5841"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "JPN" 
               & (CSBdata[,"Split_Year"]==1982 | CSBdata[,"Split_Year"]==1984)
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("EIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M43_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.3 - all fishing - Central Indian Antarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "5843"  
               & CSBdata[,"GTY_rev"]  == "OTM"
               & CSBdata[,"Flag_CTY_Code"] == "JPN"
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M44_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Division 58.4.4 - krill fishing - Central Indian Antarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "5844"  
               & CSBdata[,"GTY_Code"]  == "OTM"
               & CSBdata[,"Flag_CTY_Code"] == "JPN"
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M4T"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Subarea 58.4-krill-Korea-unknown so distributed throughout 58.4.1 and 58.4.2"  # as if a single voyage along the coast
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "584"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "KOR"
               & CSBdata[,"TFN"]          == 6
        #      & CSBdata[,"Split_Year"]   1979-1984
              ) # end RuleSubset

dfR <- Cbed_rules[(Cbed_rules[,"ASD"]=="58.4.1" | Cbed_rules[,"ASD"]=="58.4.2")
                & (Cbed_rules[,"MEASO"]=="CIA" |  Cbed_rules[,"MEASO"]=="EIA"),]  # need to not include northern banks and seamounts
  
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M4T_A"
TypeDepthInterval<-1 # row of data frame Depth_intervals

RuleDescription <- "Subarea 58.4-trawl-France-krill catch"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "584"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "FRA"
               & CSBdata[,"TFN"]          == 6
               & CSBdata[,"Split_Year"]   == 1980
              ) # end RuleSubset

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             data.frame(MEASO = c("CIA"),Area=c(1))
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "58M4T_CI"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Subarea 58.4-krill-SUN-likely from Prydz Bay"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "584"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
        #      & CSBdata[,"TFN"]          1 | 6
        #      & CSBdata[,"Split_Year"]   1979-1984
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

############################
# Display results
############################


print.data.frame(data.frame(Rule = names(CatchDistRules),bind_rows(lapply(CatchDistRules,function(cd){cd$Distribution}))))



CD_Area58<-CatchDistRules
```
  
  
### Area 88  

Bottom trawling appears in the records for Area 88 infrequently.  In 1978, Poland undertook bottom trawling.  When the records were examined closely and in monthly sequence with Subarea 48.1, it was apparent that, given the small catch, this was likely research in the Bellingshausen Sea extending the west Antarctic Peninsula research fishing into Subarea 88.3.  The other bottom trawling to occur was a trawl survey by NZ in during the Census of Antarctic Marine Life in Subarea 88.1 the Ross Sea.  
  
Longline fishing began in Subarea 88.1 in 1997.  In the first two years it was undertaken south of 65oS in the Ross Sea.  In 1999, Small-scale Research Units (SSRUs) were established by CCAMLR (SC-CAMLR, 1999, Table 6).  These were revised over a number of years but Cape Adare was used as one of the dividing lines of these SSRUs.  Until the establishment of the MPA in the Ross Sea in 2016, the management of the longline fishery was via the SSRUs in Subarea 88.1 and SSRUs A and B in Subarea 88.2.  The component of Subarea 88.1 in the East Indian Sector has been closed since the 2005/06 season with it mostly closed prior to that.  For this reason, longline catches in Subarea 88.1 are allocated to the West Pacific Sector in the Antarctic Zone.  
  
For Subarea 88.2, longline fishing has been primarily in the eastern margins related to the Amundsen Sea, with catches allowed in SSRUs C-G.  The crossover between the West and East Pacific Sectors occurs in SSRU 882E, which also has the highest allocation of catch among the SSRUs in the Subarea.  Given that access was dependent on variability in the sea ice, the distribution of catches in this subarea was according to the proportions of seabed for longline fishing among SSRUs C-G.  
  
For Subarea 88.3, Korea has been undertaking a longline research program since their proposal was submitted to SC-CAMLR in 2015.  It is undertaken in research blocks in the Antarctic Zone of the East Pacific Sector.

  
```{r CD_Bottom_Area88, echo=FALSE}
CatchDistRules<-NULL

############################
# Bottom Fishing
############################
##############################################################################################
RuleName        <- "88B0T"
TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Area 88-trawl-POL-likely in 88.3 as extension of 48.1 research"  # when scrutinised for taxa and monthly sequence
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "88"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "POL"
               & CSBdata[,"TFN"]          == 1
               & CSBdata[,"Split_Year"]   == 1978
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88B1L_WP"
TypeDepthInterval<-3 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.1-longline-fishery concentrated south of 65oS and east of Cape Adare."

RuleSubset <- (  CSBdata[,"GAR_Code"]     == "881"
               & ( CSBdata[,"GTY_rev"]    == "LLS" | CSBdata[,"GTY_rev"]=="FPO")
     #         & CSBdata[,"Flag_CTY_Code"]== "POL"
     #         & CSBdata[,"TFN"]          == 1
     #         & CSBdata[,"Split_Year"]   == 1978
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88B1T"
TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.1-trawl-NZ-CAMLR research survey in Ross Sea"

RuleSubset <- (  CSBdata[,"GAR_Code"]     == "881"
               & CSBdata[,"GTY_rev"]      == "OTB"
               & CSBdata[,"Flag_CTY_Code"]== "NZL"
     #        & CSBdata[,"TFN"]          == 1
     #        & CSBdata[,"Split_Year"]   == 1978
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88B2L"
TypeDepthInterval<-3 # row of data frame Depth_intervals

RuleDescription <- "Subarea 8821-longline-sea ice made fishing variable in location across SSRUs" 
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "882"
               & CSBdata[,"GTY_rev"]      == "LLS"
     #         & CSBdata[,"Flag_CTY_Code"]== "NZL"
     #         & CSBdata[,"TFN"]          == 1
     #         & CSBdata[,"Split_Year"]   == 1978
              ) # end RuleSubset

dfR <- Cbed_rules[
          (  Cbed_rules[,"ASD"]=="88.2" 
           & (  Cbed_rules[,"SSRU"]=="882C" 
              | Cbed_rules[,"SSRU"]=="882D"  
              | Cbed_rules[,"SSRU"]=="882E"
              | Cbed_rules[,"SSRU"]=="882F"
              | Cbed_rules[,"SSRU"]=="882G"
              )
           )
          ,]
 
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88B3_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.3 - all fishing - East Pacific Antarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "883"  
               & CSBdata[,"GTY_rev"]  == "LLS"      
               & (CSBdata[,"Flag_CTY_Code"] == "NZL"  | CSBdata[,"Flag_CTY_Code"] == "RUS")
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


##############################################################################################
RuleName        <- "88B3L"
TypeDepthInterval<-3 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.3-longline-Korea-Research fishing in research blocks- see SC-CAMLR (2015, 2016)"

RuleSubset <- (  CSBdata[,"GAR_Code"]     == "883"
               & CSBdata[,"GTY_rev"]      == "LLS"
               & CSBdata[,"Flag_CTY_Code"]== "KOR"
  #            & CSBdata[,"TFN"]          
  #            & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88B3La"
TypeDepthInterval<-3 # row of data frame Depth_intervals

RuleDescription <- "Subarea 88.3-longline-Chile - WG-FSA-98/20 - South Shetlands extension" # was really pots but sticking with the Bulletin here.
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "883"
               & CSBdata[,"GTY_rev"]      == "LLS"
               & CSBdata[,"Flag_CTY_Code"]== "CHL"
  #            & CSBdata[,"TFN"]          == 3
  #            & CSBdata[,"Split_Year"]   == 1998
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

############################
# Midwater Fishing
############################
##############################################################################################

RuleName        <- "88M0T"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Area 88-trawl-SUN- assuming western margins of Ross Sea" # based on @RN13714  & @RN13715  
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "88"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
      #        & CSBdata[,"TFN"]          == 1 | 6
      #        & CSBdata[,"Split_Year"]   1977-1986
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("CIS"),Area=c(1))
dfR <- Cbed_rules[(Cbed_rules[,"ASD"]=="88.1" 
                & ( Cbed_rules[,"SSRU"]=="881D" 
                  | Cbed_rules[,"SSRU"]=="881E"
                  | Cbed_rules[,"SSRU"]=="881F"
                  | Cbed_rules[,"SSRU"]=="881G"
                  | Cbed_rules[,"SSRU"]=="881H"
                  | Cbed_rules[,"SSRU"]=="881I"
                  | Cbed_rules[,"SSRU"]=="881J")),]  # need to not include northern banks and seamounts

CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             fnDepthArea(TypeDepthInterval,Depth_intervals,dfR[,c("MEASO","Depth","Area")])
                                            ,MEASOareas[,"Code"],FixedProp=FALSE)
                         )) # end distribution rule
                  ) # end bind

names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M1T_EI"
TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.1-Trawl-JPN-krill"  # based on SC-III/INF/09
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "881"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "JPN"
      #        & CSBdata[,"TFN"]          ==  6
      #        & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EIA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M1T_WPa"
TypeDepthInterval<-3 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.1-trawl survey-NZL- Census of Antarctic Marine Life"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "881"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "NZL"
      #        & CSBdata[,"TFN"]          ==  3
      #        & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M1T_WPb"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.1-Trawl-SUN-Krill"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "881"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
      #        & CSBdata[,"TFN"]          ==  6
      #        & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M2T_WPa"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.2-Trawl-JPN-Krill-Ross Sea"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "882"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "JPN"
      #        & CSBdata[,"TFN"]          ==  6
      #        & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M2T_WPb"
TypeDepthInterval<-6 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.2-Trawl-SUN-Krill-Ross Sea"
RuleSubset <- (  CSBdata[,"GAR_Code"]     == "882"
               & CSBdata[,"GTY_rev"]      == "OTM"
               & CSBdata[,"Flag_CTY_Code"]== "SUN"
      #        & CSBdata[,"TFN"]          ==  6
      #        & CSBdata[,"Split_Year"]   
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("WPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName

##############################################################################################
RuleName        <- "88M3_A"
# TypeDepthInterval<-1 # row of data frame Depth_intervals
RuleDescription <- "Subarea 88.3 - all fishing - East Pacific Antarctic area"
RuleSubset <- (  CSBdata[,"GAR_Code"] == "883"  
               & CSBdata[,"GTY_rev"]  == "OTM"      
    #          & CSBdata[,"Flag_CTY_Code"]
    #          & CSBdata[,"TFN"] 
    #          & CSBdata[,"Split_Year"] 
              ) # end RuleSubset

dfRprop <- data.frame(MEASO = c("EPA"),Area=c(1))
CatchDistRules<-c(CatchDistRules
                 ,list(list(
                         Subset = RuleSubset
                        ,Description = RuleDescription
                        ,Distribution = fnPropInMareaForRule(
                                             dfRprop
                                            ,MEASOareas[,"Code"],FixedProp=TRUE)
                         )) # end distribution rule
                  ) # end bind
names(CatchDistRules)[length(CatchDistRules)]<-RuleName


############################
# Display results
############################

print.data.frame(data.frame(Rule = names(CatchDistRules),bind_rows(lapply(CatchDistRules,function(cd){cd$Distribution}))))


CD_Area88<-CatchDistRules

CatchDistRules<-c(CD_Area48,CD_Area58,CD_Area88)


```

  
 
  
  
# References    
.     
